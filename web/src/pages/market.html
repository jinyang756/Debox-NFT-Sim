<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>聚财中法虚拟交易平台 - 行情</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../assets/style.css">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // MarketFilter 组件
        function MarketFilter({ type, onChange }) {
            return (
                <div className="flex gap-2">
                    {['基金', '合约', '期权'].map(t => (
                        <button
                            key={t}
                            onClick={() => onChange(t)}
                            className={`px-4 py-2 rounded ${type === t ? 'bg-blue-600 text-white' : 'bg-gray-100'}`}
                        >
                            {t}
                        </button>
                    ))}
                </div>
            );
        }

        // Loading 组件
        function Loading() {
            return (
                <div className="flex justify-center items-center h-32">
                    <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                </div>
            );
        }

        // MarketList 组件
        function MarketList({ data }) {
            return (
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    {data.map(item => (
                        <div key={item.id} className="p-4 border rounded shadow">
                            <h3 className="font-bold">{item.name}</h3>
                            <p>净值：{item.nav}</p>
                            <p className={item.changePercent >= 0 ? 'text-green-500' : 'text-red-500'}>
                                {item.changePercent >= 0 ? '+' : ''}{item.changePercent}%
                            </p>
                        </div>
                    ))}
                </div>
            );
        }

        // MarketChart 组件 (简化版本)
        function MarketChart({ data }) {
            return (
                <div className="space-y-2">
                    <h2 className="text-lg font-bold">行情图表</h2>
                    <div className="w-full h-[300px] bg-gray-100 rounded-lg flex items-center justify-center">
                        <p className="text-gray-500">行情图表 (需要集成图表库来显示实际图表)</p>
                    </div>
                </div>
            );
        }

        // Header 组件
        function Header() {
            return (
                <div className="flex items-center justify-between px-4 py-2 bg-white shadow">
                    <div className="text-xl font-bold text-blue-600">
                        聚财中法
                    </div>
                    <div className="hidden md:flex gap-4">
                        <button className="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-100">
                            基金
                        </button>
                        <button className="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-100">
                            合约
                        </button>
                        <button className="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-100">
                            期权
                        </button>
                    </div>
                    <div className="relative">
                        <input
                            type="text"
                            placeholder="搜索基金、合约或期权..."
                            className="pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        />
                        <svg
                            className="absolute left-3 top-2.5 h-5 w-5 text-gray-400"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                strokeLinecap="round"
                                strokeLinejoin="round"
                                strokeWidth={2}
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                            />
                        </svg>
                    </div>
                </div>
            );
        }

        // TabBar 组件
        function TabBar() {
            const tabs = [
                { name: '首页', active: false },
                { name: '行情', active: true },
                { name: '交易', active: false },
                { name: '我的', active: false }
            ];

            return (
                <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 md:hidden">
                    <div className="grid grid-cols-4">
                        {tabs.map((tab, index) => (
                            <button
                                key={index}
                                className={`flex flex-col items-center justify-center py-2 px-1 ${
                                    tab.active ? 'text-blue-600' : 'text-gray-500'
                                }`}
                            >
                                <span className="text-xs mt-1">{tab.name}</span>
                            </button>
                        ))}
                    </div>
                </div>
            );
        }

        // 行情页组件
        function MarketPage() {
            const [type, setType] = React.useState('基金');
            const [data, setData] = React.useState([]);
            const [isLoading, setIsLoading] = React.useState(false);

            // 获取数据
            const fetchData = async () => {
                setIsLoading(true);
                try {
                    // 模拟API调用延迟
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    // 根据类型生成模拟数据
                    let mockData = [];
                    switch(type) {
                        case '基金':
                            mockData = [
                                { id: '1', name: '全球增长基金', nav: 12.34, changePercent: 1.5 },
                                { id: '2', name: '医疗保健基金', nav: 10.25, changePercent: -0.4 },
                                { id: '3', name: '中国机会基金', nav: 8.90, changePercent: 2.3 },
                                { id: '4', name: '科技先锋基金', nav: 15.67, changePercent: 3.2 },
                                { id: '5', name: '稳健收益基金', nav: 9.87, changePercent: 0.8 },
                                { id: '6', name: '新兴市场基金', nav: 11.56, changePercent: -1.2 }
                            ];
                            break;
                        case '合约':
                            mockData = [
                                { id: '1', name: 'BTC永续合约', nav: 35000, changePercent: 2.5 },
                                { id: '2', name: 'ETH季度合约', nav: 2800, changePercent: -1.8 },
                                { id: '3', name: 'BNB合约', nav: 320, changePercent: 0.9 },
                                { id: '4', name: 'SOL合约', nav: 120, changePercent: 5.3 }
                            ];
                            break;
                        case '期权':
                            mockData = [
                                { id: '1', name: 'BTC看涨期权', nav: 1200, changePercent: 3.2 },
                                { id: '2', name: 'ETH看跌期权', nav: 80, changePercent: -2.1 },
                                { id: '3', name: 'AAPL期权', nav: 150, changePercent: 1.7 },
                                { id: '4', name: 'TSLA期权', nav: 220, changePercent: -0.5 }
                            ];
                            break;
                        default:
                            mockData = [];
                    }
                    
                    setData(mockData);
                } catch (error) {
                    console.error('获取数据失败:', error);
                } finally {
                    setIsLoading(false);
                }
            };

            // 当类型改变时获取数据
            React.useEffect(() => {
                fetchData();
            }, [type]);

            return (
                <div className="min-h-screen bg-white flex flex-col pb-16 md:pb-0">
                    <Header />

                    <main className="flex-1 p-4 space-y-6 mt-16 md:mt-0">
                        <MarketFilter type={type} onChange={setType} />
                        {isLoading ? <Loading /> : <MarketList data={data} />}
                        <MarketChart data={data} />
                    </main>

                    <TabBar />
                </div>
            );
        }

        // 渲染应用
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MarketPage />);
    </script>
</body>
</html>